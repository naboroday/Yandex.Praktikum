Задание 1

В базе данных PG (Postgre) cуществуют 2 таблицы:

1. Таблица "opers", с операциями по обработке нарушений. В ней хранится информация по всем операциям обработки нарушений.
  |       Column       |              Type              | Description
  ---------------------+--------------------------------+--------------------------------------------------------+
  |   viol_oper_id     | bigint (PK)                    | Идентификатор операции обработки нарушения ПДД
  |   tr_viol_id       | bigint                         | Идентификатор нарушения ПДД
  |   oper_code        | integer                        | Тип операции обработки нарушения ПДД
  |   refuse_code      | integer                        | Результирующий код операции обработки нарушения ПДД
  |   isp_id           | bigint                         | Идентификатор того, кто произвел обработку нарушения ПДД
  |   date_oper        | timestamp(0) without time zone | Дата и время операции обработки нарушения ПДД
  |   viol_datetime    | timestamp(0) without time zone | Дата и время нарушения ПДД

2. Таблица "viols", с нарушениями правил дорожного движения транспортным средством.

  |   Column    |              Type              | Description
  --------------+--------------------------------+--------------------------------------------------+
  | tr_viol_id  | bigint (PK)                    | Идентификатор нарушения
  | viol_code   | integer                        | Код нарушения ПДД
  | time_check  | timestamp(0) without time zone | Дата и время нарушения ПДД
  | stage_code  | integer                        | Этап обработки нарушения ПДД
  | refuse_code | integer                        | Результирующий код обработки нарушения ПДД
  | camera_id   | integer                        | Идентификатор камеры зафиксировавший нарушение ПДД


Есть задача:
Подготовить выгрузку, содержащую информацию, за период нарушения ПДД с 2018-04-01 по 2018-04-20 с объектом выгрузки "Дата нарушения":
    Дата нарушения ПДД;
    Число нарушений ПДД всего;
    Число нарушений ПДД у которых результирующий код обработки нарушения ПДД равен 0;
    Число нарушений ПДД по которым была операция обработки тип 29;
    Число нарушений ПДД по которым не было операции обработки тип 29, а результирующий код обработки нарушения ПДД равен 0;


Вам необходимо:
1. Описать последовательность действий для выполнения задачи, постарайтесь развернуто ответить почему так и в такой последовательности.
2. Для этой задачи подготовьте все варианты запросов, которые позволят произвести соответствующую выгрузку.
3. Укажите лучший вариант запроса для данной задачи, дайте комментарий почему именно такой запрос.